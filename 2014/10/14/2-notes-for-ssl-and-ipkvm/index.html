<!DOCTYPE html><html lang="zh_CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 关于 SSL 和 IPKVM/VNC Applet 的笔记两则 · Phoenix's island</title><meta name="description" content="关于 SSL 和 IPKVM/VNC Applet 的笔记两则 - Phoenix Nemo"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/null"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://blog.phoenixlzx.com/atom.xml" title="Phoenix's island"><meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="Phoenix's island" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/static/img/avatar/avatar.jpg"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="/links/" target="_self" class="nav-list-link">LINKS</a></li><li class="nav-list-item"><a href="https://github.com/phoenixlzx" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">关于 SSL 和 IPKVM/VNC Applet 的笔记两则</h1><div class="post-info">2014年10月14日</div><div class="post-content"><p>虽然是没啥关系的两个东西不过最近没啥可写的所以放在一块做个笔记。</p>
<a id="more"></a>

<h3 id="COMODO-SSL-CA-正确的串联姿势"><a href="#COMODO-SSL-CA-正确的串联姿势" class="headerlink" title="COMODO SSL CA 正确的串联姿势"></a>COMODO SSL CA 正确的串联姿势</h3><p>有客户买了 COMODO Positive SSL 之后问我证书链变了要怎么串联。嘛确实文件变多了不过不至于这就不会了吧…</p>
<p>SSL 证书串联用 <code>cat</code> 命令的话顺序是自下而上，也就是 自己的证书 -&gt; 二级 Intermediate CA -&gt; 一级 Intermediate CA -&gt; Root CA</p>
<p>所以不管文件有多少这个顺序总是有的。以 COMODO Positive SSL 为例，假设域名为 <code>example.com</code>，<code>cat</code> 的串联命令：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">cat</span> <span class="selector-tag">example_com</span><span class="selector-class">.crt</span> <span class="selector-tag">COMODORSADomainValidationSecureServerCA</span><span class="selector-class">.crt</span> <span class="selector-tag">COMODORSAAddTrustCA</span><span class="selector-class">.crt</span> <span class="selector-tag">AddTrustExternalCARoot</span><span class="selector-class">.crt</span> &gt; <span class="selector-tag">example_com</span><span class="selector-class">.signed</span><span class="selector-class">.crt</span></span><br></pre></td></tr></table></figure>

<p>于是就可以拿着 <code>example_com.signed.crt</code> 和生成 CSR 时一并生成的 <code>example_com.key</code> 去给 NGINX 咯。</p>
<p>附一份 NGINX 配置样例。</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">      <span class="attribute">listen</span>      <span class="number">80</span>;</span><br><span class="line">      <span class="attribute">listen</span>      [::]:<span class="number">80</span> ipv6only=<span class="literal">on</span>;</span><br><span class="line">      <span class="attribute">server_name</span> example.com;</span><br><span class="line">      <span class="comment">## redirect http to https ##</span></span><br><span class="line">      <span class="attribute">rewrite</span>       <span class="regexp"> ^</span> https://example.com<span class="variable">$request_uri</span>? <span class="literal">permanent</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> ssl;</span><br><span class="line">    <span class="attribute">listen</span> [::]:<span class="number">443</span> ssl ipv6only=<span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">server_name</span> example.com;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">ssl</span>                  <span class="literal">on</span>; </span><br><span class="line">    <span class="attribute">ssl_certificate</span>      /etc/nginx/ssl/example_com.signed.crt;</span><br><span class="line">    <span class="attribute">ssl_certificate_key</span>  /etc/nginx/ssl/example_com.key;</span><br><span class="line">    <span class="attribute">ssl_protocols</span> SSLv3 TLSv1;</span><br><span class="line">    <span class="attribute">ssl_prefer_server_ciphers</span>   <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">ssl_ciphers</span> ALL:!aNULL:!ADH:!eNULL:!LOW:!EXP:RC4+RSA:+HIGH:+MEDIUM;</span><br><span class="line">    <span class="attribute">keepalive_timeout</span>    <span class="number">70</span>;</span><br><span class="line">    <span class="attribute">ssl_session_cache</span>    shared:SSL:<span class="number">10m</span>;</span><br><span class="line">    <span class="attribute">ssl_session_timeout</span>  <span class="number">10m</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">        <span class="comment"># ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后不忘打广告： [<a href="https://c.phoenixlzx.com]">https://c.phoenixlzx.com]</a></p>
<h3 id="2014-10-15-更新"><a href="#2014-10-15-更新" class="headerlink" title="=== 2014-10-15 更新 ==="></a>=== 2014-10-15 更新 ===</h3><p>SSLv3 <a target="_blank" rel="noopener" href="http://googleonlinesecurity.blogspot.com/2014/10/this-poodle-bites-exploiting-ssl-30.html">再次爆出漏洞</a>，在 Google 的新草案 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/draft-ietf-tls-downgrade-scsv-00">TLS_FALLBACK_SCSV</a> 还未明朗的情况下，目前禁用 SSLv3 是一个 <strong>不考虑 IE6</strong> 的 workaround。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ssl_protocols</span> TLSv<span class="number">1</span> TLSv<span class="number">1</span>.<span class="number">1</span> TLSv<span class="number">1</span>.<span class="number">2</span>;</span><br><span class="line"><span class="attribute">ssl_ciphers</span> ECDHE-RSA-AES<span class="number">256</span>-SHA<span class="number">384</span>:AES<span class="number">256</span>-SHA<span class="number">256</span>:HIGH:!RC<span class="number">4</span>:!MD<span class="number">5</span>:!aNULL:!eNULL:!NULL:!DH:!EDH:!AESGCM;</span><br><span class="line"><span class="attribute">ssl_prefer_server_ciphers</span> <span class="literal">on</span>;</span><br><span class="line"><span class="attribute">ssl_session_cache</span> shared:SSL:<span class="number">10</span>m;</span><br><span class="line"><span class="attribute">ssl_session_timeout</span> <span class="number">10</span>m;</span><br></pre></td></tr></table></figure>

<h3 id="IPKVM-VNC-Applet-的使用"><a href="#IPKVM-VNC-Applet-的使用" class="headerlink" title="IPKVM/VNC Applet 的使用"></a>IPKVM/VNC Applet 的使用</h3><p>从 7u45 版本之后的 Java Webstart 就不能再直接执行 Ubersmith/SolusVM/Proxmox 等等的 IPKVM/VNC Applet 了。虽然实际上是这些商业软件的错不过还是很想让人骂 Java。</p>
<p>解决方案：下载一个旧版的 Java，比如 jdk6。</p>
<p>但是直接安装也是不能运行的，因为实际上调用的 java executable 是最新版 Java 的，所以一样报错。</p>
<p>如果是在 Linux 下，jre6 的目录在 <code>$HOME/jre6/jre1.6.0_38</code>，那么下载到 Applet 之后用下面的命令启动：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">applet_path=<span class="regexp">/path/</span>to<span class="regexp">/your/</span>applet.jnlp</span><br><span class="line">~<span class="regexp">/jre6/</span>jre1.<span class="number">6.0</span>_38<span class="regexp">/bin/</span>java -verbose -Xbootclasspath<span class="regexp">/a:~/</span>jre6<span class="regexp">/jre1.6.0_38/</span>lib<span class="regexp">/javaws.jar:~/</span>jre6<span class="regexp">/jre1.6.0_38/</span>lib<span class="regexp">/deploy.jar:~/</span>jre6<span class="regexp">/jre1.6.0_38/</span>lib<span class="regexp">/plugin.jar -classpath ~/</span>jre6<span class="regexp">/jre1.6.0_38/</span>lib<span class="regexp">/deploy.jar -Djava.security.policy=file:~/</span>jre6<span class="regexp">/jre1.6.0_38/</span>lib<span class="regexp">/security/</span>javaws.policy -DtrustProxy=true -Xverify:remote -Djnlpx.home=~<span class="regexp">/jre6/</span>jre1.<span class="number">6.0</span>_38<span class="regexp">/bin -Dsun.awt.warmup=true -Djnlpx.origFilenameArg=$applet_path -Djnlpx.remove=false -esa -Xnoclassgc -Djnlpx.splashport=59999 -Djnlpx.jvm=~/</span>jre6<span class="regexp">/jre1.6.0_38/</span>bin/java -Djnlpx.vmargs=<span class="string">&quot;-esa -Xnoclassgc&quot;</span> com.sun.javaws.Main <span class="variable">$applet_path</span></span><br></pre></td></tr></table></figure>
</div></article></div></section><footer><div class="paginator"><a href="/2014/11/11/set-language-for-individual-app-in-os-x-the-elegant-way/" class="prev">PREV</a><a href="/2014/09/02/2014-natsu/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'phoenixhexo';
var disqus_identifier = '2014/10/14/2-notes-for-ssl-and-ipkvm/';
var disqus_title = '关于 SSL 和 IPKVM/VNC Applet 的笔记两则';
var disqus_url = 'https://blog.phoenixlzx.com/2014/10/14/2-notes-for-ssl-and-ipkvm/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//phoenixhexo.disqus.com/count.js" async></script><div class="copyright"><p>© 2014 - 2020 <a href="https://blog.phoenixlzx.com">Phoenix Nemo</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><!--script(async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML")--><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-48847648-1",'auto');ga('send','pageview');</script></body></html>