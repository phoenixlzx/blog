<!DOCTYPE html><html lang="zh_CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> FAT32 与 FAT32 的不同 · Phoenix's island</title><meta name="description" content="FAT32 与 FAT32 的不同 - Phoenix Nemo"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/null"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://blog.phoenixlzx.com/atom.xml" title="Phoenix's island"><meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="Phoenix's island" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/static/img/avatar/avatar.jpg"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="/links/" target="_self" class="nav-list-link">LINKS</a></li><li class="nav-list-item"><a href="https://github.com/phoenixlzx" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">FAT32 与 FAT32 的不同</h1><div class="post-info">2021年4月12日</div><div class="post-content"><p>缘由：游戏用的台式机坏掉了。</p>
<a id="more"></a>

<p>去年底配了一台 ITX，GIGABYTE AORUS X570 I PRO WIFI 大概是这个型号的主板，在一次 BIOS 升级之后无法进入 POST，配件 LED 都显示正常，风扇正常。于是按照官方说明，准备重刷 BIOS：</p>
<ul>
<li>一张闪存盘格式化为 FAT32</li>
<li>固件改名为 <code>GIGABYTE.BIN</code> 放在根目录下</li>
<li>插在 BIOS USB 接口，接通电源但不开机的情况下按 Q Flash Plus 开始刷机</li>
</ul>
<p>但是按下之后并没有描述的橙色灯亮，只看到闪存盘的存取 LED 快速闪了几下就没了动静。</p>
<p>一度以为文件有问题，或者闪存盘有问题，或者格式化有问题。于是拆了一个新的闪迪的闪存盘，重新下载保存固件，依然没有效果。</p>
<p>对着文档回顾一次操作顺序以免有疏漏，然后发现了蹊跷。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">~&gt; sudo fdisk /dev/sdb</span><br><span class="line">Welcome <span class="keyword">to</span> fdisk (util-linux 2.36.2).</span><br><span class="line">Changes will remain <span class="keyword">in</span> memory only, until you decide <span class="keyword">to</span> write them.</span><br><span class="line">Be careful before using the write command.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> help): o</span><br><span class="line">Created a new DOS disklabel with disk identifier 0x5f576f17.</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> help): n</span><br><span class="line">Partition type</span><br><span class="line">   p   primary (0 primary, 0 extended, 4 free)</span><br><span class="line">   e   extended (container <span class="keyword">for</span> logical partitions)</span><br><span class="line">Select (default p): p</span><br><span class="line">Partition number (1-4,<span class="built_in"> default </span>1):</span><br><span class="line">First sector (2048-15137279,<span class="built_in"> default </span>2048):</span><br><span class="line">Last sector, +/-sectors <span class="keyword">or</span> +/-size&#123;K,M,G,T,P&#125; (2048-15137279,<span class="built_in"> default </span>15137279):</span><br><span class="line"></span><br><span class="line">Created a new partition 1 of<span class="built_in"> type </span><span class="string">&#x27;Linux&#x27;</span> <span class="keyword">and</span> of size 7.2 GiB.</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Created a new partition 1 of type ‘Linux’ and of size 7.2 GiB.</p>
</blockquote>
<p>嗯？</p>
<p>Partition Type 是 <code>Linux</code>。这会是读取失败的原因么？于是列出所有的文件系统</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Command</span> (m for help): l</span><br><span class="line"></span><br><span class="line"><span class="attribute">00</span> Empty            <span class="number">24</span> NEC DOS          <span class="number">81</span> Minix / old Lin  bf Solaris</span><br><span class="line"><span class="attribute">01</span> FAT<span class="number">12</span>            <span class="number">27</span> Hidden NTFS Win  <span class="number">82</span> Linux swap / So  c<span class="number">1</span> DRDOS/sec (FAT-</span><br><span class="line"><span class="attribute">02</span> XENIX root       <span class="number">39</span> Plan <span class="number">9</span>           <span class="number">83</span> Linux            c<span class="number">4</span> DRDOS/sec (FAT-</span><br><span class="line"><span class="attribute">03</span> XENIX usr        <span class="number">3</span>c PartitionMagic   <span class="number">84</span> OS/<span class="number">2</span> hidden or   c<span class="number">6</span> DRDOS/sec (FAT-</span><br><span class="line"><span class="attribute">04</span> FAT<span class="number">16</span> &lt;<span class="number">32</span>M       <span class="number">40</span> Venix <span class="number">80286</span>      <span class="number">85</span> Linux extended   c<span class="number">7</span> Syrinx</span><br><span class="line"><span class="attribute">05</span> Extended         <span class="number">41</span> PPC PReP Boot    <span class="number">86</span> NTFS volume set  da Non-FS data</span><br><span class="line"><span class="attribute">06</span> FAT<span class="number">16</span>            <span class="number">42</span> SFS              <span class="number">87</span> NTFS volume set  db CP/M / CTOS / .</span><br><span class="line"><span class="attribute">07</span> HPFS/NTFS/exFAT  <span class="number">4</span>d QNX<span class="number">4</span>.x           <span class="number">88</span> Linux plaintext  de Dell Utility</span><br><span class="line"><span class="attribute">08</span> AIX              <span class="number">4</span>e QNX<span class="number">4</span>.x <span class="number">2</span>nd part  <span class="number">8</span>e Linux LVM        df BootIt</span><br><span class="line"><span class="attribute">09</span> AIX bootable     <span class="number">4</span>f QNX<span class="number">4</span>.x <span class="number">3</span>rd part  <span class="number">93</span> Amoeba           e<span class="number">1</span> DOS access</span><br><span class="line"><span class="attribute">0a</span> OS/<span class="number">2</span> Boot Manag  <span class="number">50</span> OnTrack DM       <span class="number">94</span> Amoeba BBT       e<span class="number">3</span> DOS R/O</span><br><span class="line"><span class="attribute">0b</span> W<span class="number">95</span> FAT<span class="number">32</span>        <span class="number">51</span> OnTrack DM<span class="number">6</span> Aux  <span class="number">9</span>f BSD/OS           e<span class="number">4</span> SpeedStor</span><br><span class="line"><span class="attribute">0c</span> W<span class="number">95</span> FAT<span class="number">32</span> (LBA)  <span class="number">52</span> CP/M             a<span class="number">0</span> IBM Thinkpad hi  ea Linux extended</span><br><span class="line"><span class="attribute">0e</span> W<span class="number">95</span> FAT<span class="number">16</span> (LBA)  <span class="number">53</span> OnTrack DM<span class="number">6</span> Aux  a<span class="number">5</span> FreeBSD          eb BeOS fs</span><br><span class="line"><span class="attribute">0f</span> W<span class="number">95</span> Ext&#x27;d (LBA)  <span class="number">54</span> OnTrackDM<span class="number">6</span>       a<span class="number">6</span> OpenBSD          ee GPT</span><br><span class="line"><span class="attribute">10</span> OPUS             <span class="number">55</span> EZ-Drive         a<span class="number">7</span> NeXTSTEP         ef EFI (FAT-<span class="number">12</span>/<span class="number">16</span>/</span><br><span class="line"><span class="attribute">11</span> Hidden FAT<span class="number">12</span>     <span class="number">56</span> Golden Bow       a<span class="number">8</span> Darwin UFS       f<span class="number">0</span> Linux/PA-RISC b</span><br><span class="line"><span class="attribute">12</span> Compaq diagnost  <span class="number">5</span>c Priam Edisk      a<span class="number">9</span> NetBSD           f<span class="number">1</span> SpeedStor</span><br><span class="line"><span class="attribute">14</span> Hidden FAT<span class="number">16</span> &lt;<span class="number">3</span>  <span class="number">61</span> SpeedStor        ab Darwin boot      f<span class="number">4</span> SpeedStor</span><br><span class="line"><span class="attribute">16</span> Hidden FAT<span class="number">16</span>     <span class="number">63</span> GNU HURD or Sys  af HFS / HFS+       f<span class="number">2</span> DOS secondary</span><br><span class="line"><span class="attribute">17</span> Hidden HPFS/NTF  <span class="number">64</span> Novell Netware   b<span class="number">7</span> BSDI fs          fb VMware VMFS</span><br><span class="line"><span class="attribute">18</span> AST SmartSleep   <span class="number">65</span> Novell Netware   b<span class="number">8</span> BSDI swap        fc VMware VMKCORE</span><br><span class="line"><span class="attribute">1b</span> Hidden W<span class="number">95</span> FAT<span class="number">3</span>  <span class="number">70</span> DiskSecure Mult  bb Boot Wizard hid  fd Linux raid auto</span><br><span class="line"><span class="attribute">1c</span> Hidden W<span class="number">95</span> FAT<span class="number">3</span>  <span class="number">75</span> PC/IX            bc Acronis FAT<span class="number">32</span> L  fe LANstep</span><br><span class="line"><span class="attribute">1e</span> Hidden W<span class="number">95</span> FAT<span class="number">1</span>  <span class="number">80</span> Old Minix        be Solaris boot     ff BBT</span><br><span class="line"></span><br><span class="line"><span class="attribute">Aliases</span>:</span><br><span class="line">   <span class="attribute">linux</span>          - <span class="number">83</span></span><br><span class="line">   <span class="attribute">swap</span>           - <span class="number">82</span></span><br><span class="line">   <span class="attribute">extended</span>       - <span class="number">05</span></span><br><span class="line">   <span class="attribute">uefi</span>           - EF</span><br><span class="line">   <span class="attribute">raid</span>           - FD</span><br><span class="line">   <span class="attribute">lvm</span>            - <span class="number">8</span>E</span><br><span class="line">   <span class="attribute">linuxex</span>        - <span class="number">85</span></span><br></pre></td></tr></table></figure>

<p>好家伙，看到一个 <code>0b W95 FAT32</code>。直接把分区类型改为 <code>0b</code> 再重新格式化，放入文件，插回 BIOS USB 接口，按下 Q Flash Plus，瞬间电源启动，橙色 LED 开始闪烁，说明已经开始刷写。</p>
<p>查了 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Partition_type">Wikipedia</a>，看到这么一段话：</p>
<blockquote>
<p>Lists of assigned partition types to be used in the partition table in the MBR were originally maintained by IBM and Microsoft internally. When the market of PC operating systems and disk tools grew and liberated, other vendors had a need to assign special partition types to their products as well. As Microsoft neither documented all partition types already assigned by them nor wanted to maintain foreign assignments, third parties started to simply assign partition types on their own behalf in a mostly uncoordinated trial-and-error manner. This led to various conflictive double-assignments sometimes causing severe compatibility problems between certain products.([1])[<a target="_blank" rel="noopener" href="http://msdn.microsoft.com/en-us/windows/hardware/gg463525.aspx]">http://msdn.microsoft.com/en-us/windows/hardware/gg463525.aspx]</a></p>
</blockquote>
<p>所以也就有了 Partition Type 这样一个细节导致刷写任务失败，原因是 GIGABYTE 在开发 Q Flash Plus 的时候没有考虑过不同厂家、设备、操作系统所建立的 FAT32 分区类型的不同，文档中也没有提及这个问题。顺带又看到了同样有很多 GIGABYTE 主板的用户在网络上表示他们没有办法通过这种方式刷写 BIOS，也难怪会让人困惑了。</p>
<p>再顺便，使用闪迪出厂自带的 FAT32 文件系统无法正常被 Q Flash Plus 识别，是不是也说明了闪迪的闪存盘在出厂时建立的文件系统类型并不是 <code>0b W95 FAT32</code>？</p>
<p>总之：</p>
<ol>
<li>我的主板终于修好了。</li>
<li>开发任何功能时要考虑好对不同硬件、系统、环境的兼容性。</li>
<li>下次买主板，还是乖乖选败家之眼 ASUS ROG 吧（笑</li>
</ol>
</div></article></div></section><footer><div class="paginator"><a href="/2021/07/07/fix-lvm-xfs-input-output-error/" class="prev">PREV</a><a href="/2021/02/03/update-supermicro-bios-to-avoid-2021-issue-in-linux/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'phoenixhexo';
var disqus_identifier = '2021/04/12/difference-between-fat32/';
var disqus_title = 'FAT32 与 FAT32 的不同';
var disqus_url = 'https://blog.phoenixlzx.com/2021/04/12/difference-between-fat32/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//phoenixhexo.disqus.com/count.js" async></script><div class="copyright"><p>© 2014 - 2021 <a href="https://blog.phoenixlzx.com">Phoenix Nemo</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><!--script(async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML")--><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-48847648-1",'auto');ga('send','pageview');</script></body></html>